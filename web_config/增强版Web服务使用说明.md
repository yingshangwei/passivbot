# Passivbot 增强版Web服务使用说明

## 🚀 功能概述

增强版Web服务提供了完整的Passivbot配置、回测和结果分析功能，包括：

- ✅ **配置管理**: 可视化参数配置，支持预设模板
- ✅ **配置保存**: 直接保存配置到服务器
- ✅ **在线回测**: 在Web界面中执行回测
- ✅ **实时监控**: 实时查看回测执行状态
- ✅ **结果分析**: 自动分析并展示回测盈利结果
- ✅ **数据导出**: 支持配置和结果导出

## 🛠️ 启动服务

### 方法一：使用快速启动脚本（推荐）

```bash
# 启动增强版Web服务
./quick_start.sh web-enhanced
```

### 方法二：直接启动

```bash
cd web_config
python3 start_enhanced.py
```

## 📱 访问界面

启动成功后，访问：`http://localhost:8080`

## 🎯 使用流程

### 1. 配置管理

**基础配置**：
- 回测开始/结束日期
- 初始资金
- 交易所选择
- 交易对选择

**策略参数**：
- 多头策略参数（入场网格间距、初始数量等）
- 空头策略参数
- 风险控制参数

**预设配置**：
- 保守型：低风险，小仓位
- 稳健型：中等风险，平衡配置
- 激进型：高风险，大仓位

### 2. 配置操作

1. **生成配置**: 点击"生成配置文件"按钮
2. **保存到服务器**: 点击"保存配置到服务器"按钮
3. **复制配置**: 复制生成的JSON配置
4. **下载配置**: 下载配置文件到本地

### 3. 回测执行

1. **检查状态**: 查看系统状态和配置文件状态
2. **开始回测**: 点击"开始回测"按钮
3. **监控进度**: 实时查看回测执行状态
4. **查看结果**: 回测完成后自动显示结果

### 4. 结果分析

**核心盈利指标**：
- 初始资金 vs 最终资金
- 总收益和总收益率
- 最大回撤
- 夏普比率和索提诺比率

**交易统计**：
- 总交易次数
- 胜率
- 平均持仓时间
- 日均持仓数

## 🔧 API接口

### 状态查询
```
GET /api/status
```

### 保存配置
```
POST /api/save-config
Content-Type: application/json

{
  "backtest": { ... },
  "bot": { ... },
  "live": { ... }
}
```

### 执行回测
```
POST /api/run-backtest
```

### 获取回测结果
```
GET /api/backtest/results
```

## 📊 回测结果格式

```json
{
  "execution": {
    "timestamp": 1694000000,
    "success": true,
    "stdout": "回测执行输出",
    "stderr": "错误信息"
  },
  "latest_backtest": "/path/to/latest/backtest",
  "analysis": {
    "gain": 0.9913,
    "drawdown_worst": 0.1456,
    "sharpe_ratio": -0.0071,
    "positions_held_per_day": 24.1,
    "position_held_hours_mean": 1.34
  }
}
```

## ⚠️ 注意事项

### 安全提醒
- 回测执行需要较长时间（通常3-10分钟）
- 建议先小资金测试策略
- 定期监控交易状态
- 充分理解参数含义后再进行实盘交易

### 技术限制
- 回测超时时间：5分钟
- 最大轮询次数：60次
- 轮询间隔：5秒
- 支持的文件格式：JSON

### 故障排除

**端口占用**：
```bash
# 查看端口占用
netstat -tlnp | grep :808

# 停止占用进程
kill <PID>
```

**配置文件不存在**：
- 确保先保存配置再进行回测
- 检查配置文件格式是否正确

**回测失败**：
- 检查网络连接
- 确认交易所数据可用
- 查看错误日志

## 🔄 版本对比

| 功能 | 基础版 | 增强版 |
|------|--------|--------|
| 配置生成 | ✅ | ✅ |
| 配置保存 | ❌ | ✅ |
| 在线回测 | ❌ | ✅ |
| 结果分析 | ❌ | ✅ |
| 实时监控 | ❌ | ✅ |
| API接口 | ❌ | ✅ |

## 📝 更新日志

### v2.0.0 (增强版)
- ✅ 新增配置保存到服务器功能
- ✅ 新增在线回测执行功能
- ✅ 新增实时结果分析功能
- ✅ 新增API接口支持
- ✅ 优化用户界面和交互体验
- ✅ 新增预设配置模板
- ✅ 新增结果导出功能

### v1.0.0 (基础版)
- ✅ 基础配置生成功能
- ✅ 配置文件下载功能
- ✅ 简单Web界面

## 🆘 技术支持

如遇到问题，请：

1. 检查系统状态：`./quick_start.sh check`
2. 查看日志文件
3. 确认网络连接
4. 验证配置文件格式

---

**Passivbot 增强版Web服务** - 让量化交易配置更简单！