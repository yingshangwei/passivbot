# Passivbot è¿è¡Œæµç¨‹æŒ‡å—

## ğŸš€ å®Œæ•´è¿è¡Œæµç¨‹

### ç¬¬ä¸€æ­¥ï¼šç¯å¢ƒå‡†å¤‡

#### 1.1 æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /Users/shangwei.ying/workspace/git/passivbot

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate

# éªŒè¯ç¯å¢ƒ
python --version  # åº”è¯¥æ˜¾ç¤º Python 3.13.3
```

#### 1.2 éªŒè¯ä¾èµ–
```bash
# æµ‹è¯•æ ¸å¿ƒæ¨¡å—å¯¼å…¥
python -c "
import passivbot_rust
import ccxt
import pandas as pd
import numpy as np
print('âœ… æ‰€æœ‰ä¾èµ–æ­£å¸¸')
"
```

### ç¬¬äºŒæ­¥ï¼šé…ç½®è®¾ç½®

#### 2.1 é…ç½®APIå¯†é’¥
```bash
# ç¼–è¾‘APIå¯†é’¥æ–‡ä»¶
nano api-keys.json
```

**APIå¯†é’¥é…ç½®ç¤ºä¾‹**:
```json
{
  "binance": {
    "api_key": "your_binance_api_key",
    "secret": "your_binance_secret",
    "sandbox": false
  },
  "bybit": {
    "api_key": "your_bybit_api_key", 
    "secret": "your_bybit_secret",
    "sandbox": false
  }
}
```

#### 2.2 åˆ›å»ºäº¤æ˜“é…ç½®
```bash
# å¤åˆ¶é…ç½®æ¨¡æ¿
cp configs/template.json my_config.json

# ç¼–è¾‘é…ç½®æ–‡ä»¶
nano my_config.json
```

**å…³é”®é…ç½®å‚æ•°è¯´æ˜**:
```json
{
  "live": {
    "user": "your_account_name",  // å¯¹åº”api-keys.jsonä¸­çš„è´¦æˆ·å
    "approved_coins": ["BTCUSDT", "ETHUSDT"],  // å…è®¸äº¤æ˜“çš„å¸ç§
    "leverage": 1.0,  // æ æ†å€æ•°
    "market_orders_allowed": false  // æ˜¯å¦å…è®¸å¸‚ä»·å•
  },
  "bot": {
    "long": {
      "n_positions": 7,  // å¤šå¤´ä»“ä½æ•°é‡
      "entry_grid_spacing_pct": 0.027,  // å…¥åœºç½‘æ ¼é—´è·
      "close_grid_markup_start": 0.006  // å¹³ä»“ç½‘æ ¼èµ·å§‹æ ‡è®°
    },
    "short": {
      "n_positions": 7,  // ç©ºå¤´ä»“ä½æ•°é‡
      "entry_grid_spacing_pct": 0.037,  // å…¥åœºç½‘æ ¼é—´è·
      "close_grid_markup_start": 0.020  // å¹³ä»“ç½‘æ ¼èµ·å§‹æ ‡è®°
    }
  }
}
```

### ç¬¬ä¸‰æ­¥ï¼šæ•°æ®å‡†å¤‡

#### 3.1 ä¸‹è½½å†å²æ•°æ®ï¼ˆç”¨äºå›æµ‹ï¼‰
```bash
# ä¸‹è½½å¸å®‰æ•°æ®
python src/downloader.py --exchange binance --symbols BTCUSDT,ETHUSDT --timeframes 1m --start_date 2024-01-01 --end_date 2024-12-01

# ä¸‹è½½Bybitæ•°æ®
python src/downloader.py --exchange bybit --symbols BTCUSDT,ETHUSDT --timeframes 1m --start_date 2024-01-01 --end_date 2024-12-01
```

#### 3.2 éªŒè¯æ•°æ®å®Œæ•´æ€§
```bash
# æ£€æŸ¥ä¸‹è½½çš„æ•°æ®
ls -la backtests/
```

### ç¬¬å››æ­¥ï¼šç­–ç•¥å›æµ‹

#### 4.1 å•å¸ç§å›æµ‹
```bash
# å›æµ‹BTCUSDT
python src/backtest.py my_config.json --live.approved_coins BTCUSDT --backtest.start_date 2024-01-01 --backtest.end_date 2024-06-01
```

#### 4.2 å¤šå¸ç§å›æµ‹
```bash
# å›æµ‹å¤šä¸ªå¸ç§
python src/backtest.py my_config.json --live.approved_coins BTCUSDT,ETHUSDT --backtest.start_date 2024-01-01 --backtest.end_date 2024-06-01
```

#### 4.3 æŸ¥çœ‹å›æµ‹ç»“æœ
```bash
# æŸ¥çœ‹å›æµ‹ç»“æœæ–‡ä»¶
ls -la backtests/binance/BTCUSDT/

# æŸ¥çœ‹æ€§èƒ½æŠ¥å‘Š
cat backtests/binance/BTCUSDT/backtest_result.json
```

### ç¬¬äº”æ­¥ï¼šå‚æ•°ä¼˜åŒ–

#### 5.1 è¿è¡Œä¼˜åŒ–å™¨
```bash
# åŸºç¡€ä¼˜åŒ–ï¼ˆå°è§„æ¨¡æµ‹è¯•ï¼‰
python src/optimize.py my_config.json --optimize.iters 100 --optimize.population_size 20

# å®Œæ•´ä¼˜åŒ–ï¼ˆéœ€è¦è¾ƒé•¿æ—¶é—´ï¼‰
python src/optimize.py my_config.json --optimize.iters 1000 --optimize.population_size 50
```

#### 5.2 æŸ¥çœ‹ä¼˜åŒ–ç»“æœ
```bash
# æŸ¥çœ‹ä¼˜åŒ–ç»“æœ
ls -la backtests/binance/BTCUSDT/optimize/

# æŸ¥çœ‹æœ€ä½³é…ç½®
cat backtests/binance/BTCUSDT/optimize/best_result.json
```

### ç¬¬å…­æ­¥ï¼šå®ç›˜äº¤æ˜“

#### 6.1 æ¨¡æ‹Ÿäº¤æ˜“æµ‹è¯•
```bash
# ä½¿ç”¨æ¨¡æ‹Ÿæ¨¡å¼æµ‹è¯•ï¼ˆå¦‚æœäº¤æ˜“æ‰€æ”¯æŒï¼‰
python src/main.py my_config.json --live.user your_account_name
```

#### 6.2 å®ç›˜äº¤æ˜“å¯åŠ¨
```bash
# å¯åŠ¨å®ç›˜äº¤æ˜“ï¼ˆè°¨æ…æ“ä½œï¼ï¼‰
python src/main.py my_config.json --live.user your_account_name
```

#### 6.3 ç›‘æ§äº¤æ˜“çŠ¶æ€
```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
tail -f logs/passivbot.log

# æŸ¥çœ‹äº¤æ˜“çŠ¶æ€
python src/tools/fetch_balance.py --user your_account_name
```

### ç¬¬ä¸ƒæ­¥ï¼šç»“æœåˆ†æ

#### 7.1 ç”Ÿæˆäº¤æ˜“æŠ¥å‘Š
```bash
# ç”Ÿæˆæ€§èƒ½åˆ†æå›¾è¡¨
python src/plotting.py --config my_config.json --start_date 2024-01-01 --end_date 2024-12-01
```

#### 7.2 äº¤äº’å¼åˆ†æ
```bash
# å¯åŠ¨äº¤äº’å¼å›¾è¡¨
python src/interactive_plot.py
```

## ğŸ”§ å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

### ç¯å¢ƒç®¡ç†
```bash
# æ¿€æ´»ç¯å¢ƒ
source venv/bin/activate

# é€€å‡ºç¯å¢ƒ
deactivate

# æ£€æŸ¥ç¯å¢ƒ
which python
pip list
```

### é…ç½®ç®¡ç†
```bash
# æŸ¥çœ‹é…ç½®æ¨¡æ¿
cat configs/template.json

# éªŒè¯é…ç½®æ–‡ä»¶
python -c "
import json
with open('my_config.json', 'r') as f:
    config = json.load(f)
    print('é…ç½®éªŒè¯é€šè¿‡')
"
```

### æ•°æ®ç®¡ç†
```bash
# æ¸…ç†ç¼“å­˜æ•°æ®
rm -rf backtests/*/cache/

# å‹ç¼©å†å²æ•°æ®
python src/downloader.py --compress_cache true
```

### ç›‘æ§å‘½ä»¤
```bash
# æŸ¥çœ‹ç³»ç»Ÿèµ„æº
htop

# æŸ¥çœ‹ç£ç›˜ä½¿ç”¨
df -h

# æŸ¥çœ‹ç½‘ç»œè¿æ¥
netstat -an | grep ESTABLISHED
```

## ğŸ“Š æ€§èƒ½ç›‘æ§

### å…³é”®æŒ‡æ ‡ç›‘æ§
1. **æ”¶ç›Šç‡**: æ€»æ”¶ç›Šã€å¹´åŒ–æ”¶ç›Šã€æœ€å¤§å›æ’¤
2. **é£é™©æŒ‡æ ‡**: å¤æ™®æ¯”ç‡ã€ç´¢æè¯ºæ¯”ç‡ã€VaR
3. **äº¤æ˜“ç»Ÿè®¡**: äº¤æ˜“æ¬¡æ•°ã€èƒœç‡ã€å¹³å‡æŒä»“æ—¶é—´
4. **ç³»ç»ŸæŒ‡æ ‡**: CPUä½¿ç”¨ç‡ã€å†…å­˜ä½¿ç”¨ã€ç½‘ç»œå»¶è¿Ÿ

### ç›‘æ§è„šæœ¬ç¤ºä¾‹
```bash
#!/bin/bash
# monitor.sh - äº¤æ˜“ç›‘æ§è„šæœ¬

while true; do
    echo "=== $(date) ==="
    
    # æ£€æŸ¥è¿›ç¨‹çŠ¶æ€
    ps aux | grep passivbot
    
    # æ£€æŸ¥æ—¥å¿—é”™è¯¯
    tail -n 10 logs/passivbot.log | grep ERROR
    
    # æ£€æŸ¥è´¦æˆ·ä½™é¢
    python src/tools/fetch_balance.py --user your_account_name
    
    sleep 300  # æ¯5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
done
```

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

#### 1. APIè¿æ¥é—®é¢˜
```bash
# æ£€æŸ¥ç½‘ç»œè¿æ¥
ping api.binance.com
ping api.bybit.com

# æ£€æŸ¥APIå¯†é’¥
python -c "
import ccxt
exchange = ccxt.binance({
    'apiKey': 'your_key',
    'secret': 'your_secret',
    'sandbox': True
})
print(exchange.fetch_balance())
"
```

#### 2. æ•°æ®ä¸‹è½½é—®é¢˜
```bash
# æ¸…ç†å¹¶é‡æ–°ä¸‹è½½
rm -rf backtests/binance/BTCUSDT/
python src/downloader.py --exchange binance --symbols BTCUSDT --timeframes 1m --start_date 2024-01-01
```

#### 3. å†…å­˜ä¸è¶³
```bash
# å‡å°‘å¹¶å‘æ•°é‡
python src/optimize.py my_config.json --optimize.n_cpus 2

# æ¸…ç†ä¸´æ—¶æ–‡ä»¶
find . -name "*.tmp" -delete
```

#### 4. é…ç½®é”™è¯¯
```bash
# éªŒè¯é…ç½®è¯­æ³•
python -c "
import hjson
with open('my_config.json', 'r') as f:
    config = hjson.load(f)
    print('é…ç½®è¯­æ³•æ­£ç¡®')
"
```

## ğŸ“ˆ æœ€ä½³å®è·µ

### 1. é£é™©ç®¡ç†
- è®¾ç½®åˆç†çš„ä»“ä½å¤§å°
- ä½¿ç”¨æ­¢æŸæœºåˆ¶
- å®šæœŸæ£€æŸ¥é£é™©æŒ‡æ ‡
- åˆ†æ•£æŠ•èµ„å¤šä¸ªå¸ç§

### 2. å‚æ•°è°ƒä¼˜
- å…ˆè¿›è¡Œå……åˆ†å›æµ‹
- ä½¿ç”¨ä¼˜åŒ–å™¨å¯»æ‰¾æœ€ä½³å‚æ•°
- å®šæœŸé‡æ–°ä¼˜åŒ–å‚æ•°
- é¿å…è¿‡åº¦æ‹Ÿåˆ

### 3. ç³»ç»Ÿç»´æŠ¤
- å®šæœŸæ›´æ–°ä¾èµ–åŒ…
- ç›‘æ§ç³»ç»Ÿèµ„æºä½¿ç”¨
- å¤‡ä»½é‡è¦é…ç½®æ–‡ä»¶
- ä¿æŒæ—¥å¿—è®°å½•

### 4. å®‰å…¨æªæ–½
- ä½¿ç”¨APIå¯†é’¥æƒé™é™åˆ¶
- å®šæœŸæ›´æ¢APIå¯†é’¥
- ç›‘æ§å¼‚å¸¸äº¤æ˜“æ´»åŠ¨
- è®¾ç½®èµ„é‡‘ä½¿ç”¨ä¸Šé™

## ğŸ”„ è‡ªåŠ¨åŒ–éƒ¨ç½²

### ä½¿ç”¨systemdæœåŠ¡ï¼ˆLinuxï¼‰
```bash
# åˆ›å»ºæœåŠ¡æ–‡ä»¶
sudo nano /etc/systemd/system/passivbot.service

[Unit]
Description=Passivbot Trading Bot
After=network.target

[Service]
Type=simple
User=your_username
WorkingDirectory=/path/to/passivbot
ExecStart=/path/to/passivbot/venv/bin/python src/main.py my_config.json
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target

# å¯åŠ¨æœåŠ¡
sudo systemctl enable passivbot
sudo systemctl start passivbot
```

### ä½¿ç”¨Dockeréƒ¨ç½²
```bash
# æ„å»ºé•œåƒ
docker build -t passivbot .

# è¿è¡Œå®¹å™¨
docker run -d --name passivbot \
  -v $(pwd)/configs:/app/configs \
  -v $(pwd)/logs:/app/logs \
  passivbot
```

## ğŸ“ æ—¥å¿—ç®¡ç†

### æ—¥å¿—é…ç½®
```bash
# åˆ›å»ºæ—¥å¿—ç›®å½•
mkdir -p logs

# é…ç½®æ—¥å¿—è½®è½¬
sudo nano /etc/logrotate.d/passivbot

/path/to/passivbot/logs/*.log {
    daily
    rotate 30
    compress
    delaycompress
    missingok
    notifempty
    create 644 your_username your_username
}
```

### æ—¥å¿—åˆ†æ
```bash
# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
grep ERROR logs/passivbot.log

# ç»Ÿè®¡äº¤æ˜“æ¬¡æ•°
grep "Trade executed" logs/passivbot.log | wc -l

# æŸ¥çœ‹æ€§èƒ½æŒ‡æ ‡
grep "PnL" logs/passivbot.log | tail -10
```

---

*æœ¬æŒ‡å—æ¶µç›–äº†Passivbotçš„å®Œæ•´è¿è¡Œæµç¨‹ï¼Œä»ç¯å¢ƒå‡†å¤‡åˆ°å®ç›˜äº¤æ˜“çš„å…¨è¿‡ç¨‹ã€‚è¯·æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´é…ç½®å‚æ•°ï¼Œå¹¶å§‹ç»ˆæ³¨æ„é£é™©ç®¡ç†ã€‚*
